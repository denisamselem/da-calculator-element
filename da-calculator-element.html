<!--
    @license
    Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
    This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
    The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
    The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
    Code distributed by Google as part of the polymer project is also
    subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../polymer/polymer.html">

<!--

##### Example

    <da-calculator-element theme="dark"></da-calculator-element>

@element da-calculator-element
@status alpha
@homepage http://denisamselem.github.io/da-calculator-element
-->
<polymer-element name="da-calculator-element" attributes="theme">
  
  <template>
    <link rel="stylesheet" href="da-calculator-element.css">
	<div class="{{theme}}" layout  center>
		<div id="daConsole" class="daConsole">
			<h2>da-calculator-element instance using the {{theme}} theme.</h2>
			<div id="line"></div>
		</div>
		<div id="calculator">
			<FORM NAME="Calc">
				<TABLE>
					<TR>
						<TD>
							<INPUT class="sonuc" id="calcInput" TYPE="text"  NAME="Input" Size="19">
							<br>
						</TD>
					</TR>
					<TR>
						<TD>
							<INPUT class="button blue small" TYPE="button" NAME="one"   VALUE="  1  " >
							<INPUT class="button blue small" TYPE="button" NAME="two"   VALUE="  2  " >
							<INPUT class="button blue small" TYPE="button" NAME="three" VALUE="  3  " >
							<INPUT class="button red small" TYPE="button" NAME="plus"  VALUE="  +  " >
							<br>
							<INPUT class="button blue small" TYPE="button" NAME="four"  VALUE="  4  " >
							<INPUT class="button blue small" TYPE="button" NAME="five"  VALUE="  5  " >
							<INPUT class="button blue small" TYPE="button" NAME="six"   VALUE="  6  " >
							<INPUT class="button red small" TYPE="button" NAME="minus" VALUE="  -  " >
							<br>
							<INPUT class="button blue small" TYPE="button" NAME="seven" VALUE="  7  " >
							<INPUT class="button blue small" TYPE="button" NAME="eight" VALUE="  8  " >
							<INPUT class="button blue small" TYPE="button" NAME="nine"  VALUE="  9  " >
							<INPUT class="button red small" TYPE="button" NAME="times" VALUE="  x  " >
							<br>
							<INPUT class="button blue small" TYPE="button" NAME="clear" VALUE="  c  " >
							<INPUT class="button blue small" TYPE="button" NAME="zero"  VALUE="  0  " >
							<INPUT class="button green small" TYPE="button" NAME="DoIt"  VALUE="  =  " >
							<INPUT class="button red small" TYPE="button" NAME="div"   VALUE="  /  " >
							<br>
						</TD>
					</TR>
				</TABLE>
			</FORM>
			<div class="credits"><a class="copyright" href="http://cyber-warrior.org/MAST3R">Borrowed from MAST3R</a>
			</div>
		</div>
	</div>
  </template>

  <script>
      Polymer({
	      theme:"default",
	      validKeys : "+=/*x-0123456789c",

	      ready: function() {
	        this.addEventListener('click', this.onClick);
	        this.consoleLog("Ready!");
	      },

	      consoleLog: function(message) {
			this.$.line.textContent += message;
	      },

	      onClick: function(evt) {
	      	var target = evt.path[0];
	      	if (target.value) {
	      		var value = target.value.trim().toLowerCase();
	      		if (this.validKeys.indexOf(value)>=0) {
	      			if(value=="c") {
	      				this.inputReset();
	      			} else 
	      			if (value=="=") {
	      				this.inputCalculate();
	      			} else 
	      			if (value=="x") {
	      				this.inputAppend("*");
	      			} else 
		      			this.inputAppend(value);
	      		}
	      	}
	      },

	      inputAppend: function(more) {
	      	if(this.$ && this.$.calcInput)
		      	this.$.calcInput.value += more;
	      },

	      inputReset: function() {
	      	if(this.$ && this.$.calcInput)
		      	this.$.calcInput.value = '';	      	
	      },

	      /*********************************************************************************************
	      ************** BETTER PAY ATTENTION TO THIS **************************************************
	      **
	      **				Using EVAL() to calculate()
	      **
	      **	TODO: 			pros/cons of sticking to eval() + extra input filtering and sanetization 
	      **			versus 	pros/cons of writing our own calculator expression parser and evaluator.
	      */
	      inputCalculate: function() {
	      	if(this.$ && this.$.calcInput)
		      	this.$.calcInput.value = eval(this.$.calcInput.value);
	      },

	      themeChanged: function() {
	        if (this.theme) {
	          this.theme = this.theme.toLowerCase();
	      	}
    	  }
	    }
   	);

  </script>

</polymer-element>
